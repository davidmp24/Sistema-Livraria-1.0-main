{% extends "index.html" %}

{% block content %}
    <h1>Novo Cliente</h1>

    <form method="POST" action="{{ url_for('clientes') }}" style="margin-top: 20px;">
        <label for="nome_completo">Nome Completo:</label>
        <input type="text" id="nome_completo" name="nome_completo" required>
    
        <label for="data_nascimento">Data de Nascimento:</label>
        <input type="date" id="data_nascimento" name="data_nascimento" required>
    
        <label for="identidade">Número de Identidade:</label>
        <input type="text" id="identidade" name="identidade" required>
    
        <label for="telefone">Telefone:</label>
        <input type="number" id="telefone" name="telefone" required>
    
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required> 
    
        <label for="cep">CEP:</label>
        <input type="text" id="cep" name="cep" required>
        <button type="button" class="btn btn-secondary" onclick="buscarEndereco()">Buscar</button>
        
        <label for="rua">Rua:</label>
        <input type="text" id="rua" name="rua" required>
    
        <label for="bairro">Bairro:</label>
        <input type="text" id="bairro" name="bairro" required>
    
        <label for="cidade">Cidade:</label>
        <input type="text" id="cidade" name="cidade" required>
    
        <label for="profissao">Profissão:</label>
        <input type="text" id="profissao" name="profissao" required>
    
        <label for="escolaridade">Escolaridade:</label>
        <select id="escolaridade" name="escolaridade" required>
            <option value="">Selecione o nível de escolaridade</option>
            <option value="Fundamental">Ensino Fundamental</option>
            <option value="Médio">Ensino Médio</option>
            <option value="Superior">Ensino Superior</option>
            <option value="Pós-graduação">Pós-graduação</option>
            <option value="Não Estudando">Não está estudando</option>
        </select>
    
        <div class="form-actions">
            <button type="submit">Cadastrar Cliente</button>
            <button type="button" onclick="window.location.href='{{ url_for('clientes') }}'">Cancelar</button>
        </div>
    </form>

    <script>
        function buscarEndereco() {
            const cep = document.getElementById('cep').value;
            fetch(`/buscar_endereco?cep=${cep}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('CEP não encontrado');
                    }
                    return response.json();
                })
                .then(data => {
                    document.getElementById('rua').value = data.rua;
                    document.getElementById('bairro').value = data.bairro;
                    document.getElementById('cidade').value = data.cidade;
                })
                .catch(error => {
                    alert(error.message);
                });
        }
    </script>
{% endblock %}
